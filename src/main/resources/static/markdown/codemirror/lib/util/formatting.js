(function(){function u(d){for(var e=[/for\s*?\((.*?)\)/,/\"(.*?)(\"|$)/,/\'(.*?)(\'|$)/,/\/\*(.*?)(\*\/|$)/,/\/\/.*/],f=[],a=0;a<e.length;a++)for(var c=0;c<d.length;){var b=d.substr(c).match(e[a]);if(null!=b)f.push({start:c+b.index,end:c+b.index+b[0].length}),c+=b.index+Math.max(1,b[0].length);else break}f.sort(function(a,b){return a.start-b.start});return f}CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(d){return d.replace(/(;|\{|\})([^\r\n])/g,
"$1\n$2")}});CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(d){var e=0,f=/(;|\{|\})([^\r\n;])/g,a=u(d);if(null!=a){for(var c="",b=0;b<a.length;b++)a[b].start>e&&(c+=d.substring(e,a[b].start).replace(f,"$1\n$2"),e=a[b].start),a[b].start<=e&&a[b].end>=e&&(c+=d.substring(e,a[b].end),e=a[b].end);e<d.length&&(c+=d.substr(e).replace(f,"$1\n$2"));return c}return d.replace(f,"$1\n$2")}});CodeMirror.extendMode("xml",{commentStart:"\x3c!--",
commentEnd:"--\x3e",wordWrapChars:["\x3e"],autoFormatLineBreaks:function(d){d=d.split("\n");for(var e=/(^\s*?<|^[^<]*?)(.+)(>\s*?$|[^>]*?$)/,f=/</g,a=/(>)([^\r\n])/g,c=0;c<d.length;c++){var b=d[c].match(e);null!=b&&3<b.length&&(d[c]=b[1]+b[2].replace(f,"\n$\x26").replace(a,"$1\n$2")+b[3])}return d.join("\n")}});CodeMirror.defineExtension("commentRange",function(d,e,f){var a=CodeMirror.innerMode(this.getMode(),this.getTokenAt(e).state).mode,c=this;this.operation(function(){if(d)c.replaceRange(a.commentEnd,
f),c.replaceRange(a.commentStart,e),e.line==f.line&&e.ch==f.ch&&c.setCursor(e.line,e.ch+a.commentStart.length);else{var b=c.getRange(e,f),p=b.indexOf(a.commentStart),g=b.lastIndexOf(a.commentEnd);-1<p&&-1<g&&g>p&&(b=b.substr(0,p)+b.substring(p+a.commentStart.length,g)+b.substr(g+a.commentEnd.length));c.replaceRange(b,e,f)}})});CodeMirror.defineExtension("autoIndentRange",function(d,e){var f=this;this.operation(function(){for(var a=d.line;a<=e.line;a++)f.indentLine(a,"smart")})});CodeMirror.defineExtension("autoFormatRange",
function(d,e){var f=this;f.operation(function(){for(var a=d.line,c=e.line;a<=c;++a){var b={line:a,ch:a==d.line?d.ch:0},p={line:a,ch:a==c?e.ch:null},g;var m=f,q=a,h=b.ch;g=p.ch;var k=m.getMode(),l=m.getLine(q);null==g&&(g=l.length);if(k.innerMode){var m=m.getTokenAt({line:q,ch:h}).state,q=CodeMirror.innerMode(k,m).mode,r=[],n=new CodeMirror.StringStream(l);for(n.pos=n.start=h;;){k.token(n,m);var t=CodeMirror.innerMode(k,m).mode;if(t!=q){var s=n.start;"xml"==q.name&&"\x3e"==l.charAt(n.pos-1)&&(s=n.pos);
r.push({from:h,to:s,mode:q});h=s;q=t}if(n.pos>=g)break;n.start=n.pos}h<g&&r.push({from:h,to:g,mode:q});g=r}else g=[{from:h,to:g,mode:k}];h="";k=f.getRange(b,p);for(l=0;l<g.length;++l)m=1<g.length?k.slice(g[l].from,g[l].to):k,h&&(h+="\n"),h=g[l].mode.autoFormatLineBreaks?h+g[l].mode.autoFormatLineBreaks(m):h+k;if(h!=k){g=0;for(k=h.indexOf("\n");-1!=k;k=h.indexOf("\n",k+1),++g);f.replaceRange(h,b,p);a+=g;c+=g}}for(a=d.line+1;a<=c;++a)f.indentLine(a,"smart");f.setSelection(d,f.getCursor(!1))})})})();